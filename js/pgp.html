<!DOCTYPE html>
<html>
<head>
    <title>pgp</title>
    <script src="openpgp.min.js"></script>
</head>
<body>
    <script> 
    async function generateKeys() {
        const { privateKey, publicKey, revocationCertificate } = await openpgp.generateKey({
            type: 'ecc', // Type of the key, defaults to ECC
            curve: 'curve25519', // ECC curve name, defaults to curve25519
            userIDs: [{ name: 'Jon Smith', email: 'jon@example.com' }], // you can pass multiple user IDs
            passphrase: 'super long and hard to guess secret', // protects the private key
            format: 'armored' // output key format, defaults to 'armoured' (other options: 'binary' or 'object')
        });

        console.log(privateKey);     // '-----BEGIN PGP PRIVATE KEY BLOCK ... '
        console.log(publicKey);      // '-----BEGIN PGP PUBLIC KEY BLOCK ... '
        console.log(revocationCertificate); // '-----BEGIN PGP PUBLIC KEY BLOCK ... '
    }
    
    async function encrypt() {
        // put keys in backtick (``) to avoid errors caused by spaces or tabs
        const publicKeyArmored = ``;
        const privateKeyArmored = ``; // encrypted private key
        const passphrase = `yourPassphrase`; // what the private key is encrypted with

        const publicKey = await openpgp.readKey({ armoredKey: publicKeyArmored });

        const privateKey = await openpgp.decryptKey({
            privateKey: await openpgp.readPrivateKey({ armoredKey: privateKeyArmored }),
            passphrase
        });

        const encrypted = await openpgp.encrypt({
            message: await openpgp.createMessage({ text: 'Hello, World!' }), // input as Message object
            encryptionKeys: publicKey,
            signingKeys: privateKey // optional
        });
        console.log(encrypted); // '-----BEGIN PGP MESSAGE ... END PGP MESSAGE-----'

        const message = await openpgp.readMessage({
            armoredMessage: encrypted // parse armoured message
        });
        const { data: decrypted, signatures } = await openpgp.decrypt({
            message,
            verificationKeys: publicKey, // optional
            decryptionKeys: privateKey
        });
        console.log(decrypted); // 'Hello, World!'
        // check signature validity (signed messages only)
        try {
            await signatures[0].verified; // throws on invalid signature
            console.log('Signature is valid');
        } catch (e) {
            throw new Error('Signature could not be verified: ' + e.message);
        }
    }
    </script>
    <p>generate a key</p>
</body>
</html>